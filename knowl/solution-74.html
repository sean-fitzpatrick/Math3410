<!DOCTYPE html>
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script>
</head>
<body class="ignore-math">
<div class="solution solution-like">
<h3 class="heading">
<span class="type">Solution</span><span class="space"> </span><span class="codenumber">5.2.3.1</span><span class="period">.</span>
</h3>
<div class="para logical">
<div class="para">We compute</div>
<div class="displaymath process-math">
\begin{align*}
T(1-x) \amp = 1(1+x^2)+0(x) = 1+x^2\\
T(x+3x^2) \amp = 0(1+x^2)+4x=4x\\
T(2-x^2) \amp = 2(1+x^2)+1(x) = 2+x+2x^2\text{.}
\end{align*}
</div>
<div class="para">We now need to write each of these in terms of the basis <span class="process-math">\(B\text{.}\)</span> We can do this by working out how to write each polynomial above in terms of <span class="process-math">\(B\text{.}\)</span> Or we can be systematic.</div>
</div> <div class="para logical">
<div class="para">Let <span class="process-math">\(P = \bbm 1\amp 0\amp 2\\-1\amp 1\amp 0\\0\amp 3\amp -1\ebm\)</span> be the matrix whose columns are given by the coefficient representations of the polynomials in <span class="process-math">\(B\)</span> with respect to the <em class="emphasis">standard basis</em> <span class="process-math">\(B_0=\{1,x,x^2\}\text{.}\)</span> For <span class="process-math">\(T(1-x)=1+x^2\)</span> we need to solve the equation</div>
<div class="displaymath process-math">
\begin{equation*}
a(1-x)+b(x+3x^2)+c(2-x^2)=1+x^2
\end{equation*}
</div>
<div class="para">for scalars <span class="process-math">\(a,b,c\text{.}\)</span> But this is equivalent to the system</div>
<div class="displaymath process-math">
\begin{align*}
a+2c \amp =1\\
-a+b \amp =0\\
3b-c \amp =1\text{,}
\end{align*}
</div>
<div class="para">which, in turn, is equivalent to the matrix equation</div>
<div class="displaymath process-math">
\begin{equation*}
\bbm 1\amp 0\amp 2\\-1\amp 1\amp 0\\0\amp 3\amp -1\ebm\bbm a\\b\\c\ebm = \bbm 1\\0\\1\ebm\text{;}
\end{equation*}
</div>
<div class="para">that is, <span class="process-math">\(PC_B(1+x^2) = C_{B_0}(1+x^2)\text{.}\)</span> Thus,</div>
<div class="displaymath process-math">
\begin{equation*}
C_B(1+x^2) = \bbm a\\b\\c\ebm = P^{-1}C_{B_0}(1+x^2) = P^{-1}\bbm 1\\0\\1\ebm\text{.}
\end{equation*}
</div>
<div class="para">Similarly, <span class="process-math">\(C_B(4x)=P^{-1}\bbm 0\\4\\0\ebm = P^{-1}C_{B_0}(4x)\text{,}\)</span> and <span class="process-math">\(C_B(2+x+2x^2)=P^{-1}\bbm 2\\1\\2\ebm = P^{-1}C_{B_0}(2+x+2x^2)\text{.}\)</span> Using the computer, we find:</div>
</div> <pre class="ptx-sagecell sagecell-sage" id="sage-116"><script type="text/x-sage">from sympy import Matrix, init_printing
init_printing()
P = Matrix(3,3,[1,0,2,-1,1,0,0,3,-1])
M = Matrix(3,3,[1,0,2,0,4,1,1,0,2])
P**-1, P**-1*M
</script></pre> <div class="para logical">
<div class="para">That is,</div>
<div class="displaymath process-math">
\begin{align*}
M_B(T) \amp =\bbm C_B(T(1-x)) \amp C_B(T(x+3x^2)) \amp C_B(T(2-x^2))\ebm\\
\amp =\bbm P^{-1}C_{B_0}T(1-x) \amp P^{-1} C_{B_0}T(x+3x^2) \amp P^{-1}C_{B_0}(T(2-x^2))\ebm\\
\amp =P^{-1}\bbm C_{B_0}(1+x^2) \amp C_{B_0}(4x)\amp C_{B_0}(2+x+2x^2)\ebm\\
\amp =\bbm 1/7\amp -6/7\amp 3/7\\1/7\amp 1/7\amp 2/7\\3/7\amp 3/7\amp -1/7\ebm
\bbm 1\amp 0\amp 2\\0\amp 4\amp 1\\1\amp 0\amp 2\ebm\\
\amp = \bbm 3/7\amp -24/7\amp 0\\3/7\amp 4/7\amp 1\\2/7\amp 12/7\amp 1\ebm\text{.}
\end{align*}
</div>
</div> <div class="para logical">
<div class="para">Letâ€™s confirm that this works. Suppose we have</div>
<div class="displaymath process-math">
\begin{align*}
p(x) \amp = C_B^{-1}\bbm a\\b\\c\ebm = a(1-x)+b(x+3x^2)+c(2-x^2)\\
\amp = (a+2c)+(-a+b)x+(3b-c)x^2\text{.}
\end{align*}
</div>
<div class="para">Then <span class="process-math">\(T(p(x))=(a+2c)(1+x^2)+(4b+c)x\text{,}\)</span> and we find</div>
<div class="displaymath process-math">
\begin{equation*}
C_B(T(p(x))) = P^{-1}\bbm a+2c\\4b+c\\a+2c\ebm = \bbm \frac37 a-\frac{24}{7}b\\\frac37 a+\frac47 b+c\\\frac27 a+\frac{12}{7}b+c\ebm\text{.}
\end{equation*}
</div>
<div class="para">On the other hand,</div>
<div class="displaymath process-math">
\begin{equation*}
M_B(T) = \bbm 3/7\amp -24/7\amp 0\\3/7\amp 4/7\amp 1\\2/7\amp 12/7\amp 1\ebm\bbm a\\b\\c\ebm = \bbm \frac37 a-\frac{24}{7}b\\\frac37 a+\frac47 b+c\\\frac27 a+\frac{12}{7}b+c\ebm\text{.}
\end{equation*}
</div>
<div class="para">The results agree, but possibly leave us a little confused.</div>
</div>
</div>
<span class="incontext"><a href="sec-matrix-operator.html#solution-74" class="internal">in-context</a></span>
</body>
</html>

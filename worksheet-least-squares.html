<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Worksheet: Least squares approximation</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Linear Algebra">
<meta property="book:author" content="Sean Fitzpatrick">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  tex: {
    inlineMath: [['\\(','\\)']],
    tags: "none",
    tagSide: "right",
    tagIndent: ".8em",
    packages: {'[+]': ['base', 'extpfeil', 'ams', 'amscd', 'color', 'newcommand', 'knowl']}
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore|ignore-math",
    processHtmlClass: "process-math",
    renderActions: {
        findScript: [10, function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        }, '']
    },
  },
  chtml: {
    scale: 0.98,
    mtextInheritFont: true
  },
  loader: {
    load: ['input/asciimath', '[tex]/extpfeil', '[tex]/amscd', '[tex]/color', '[tex]/newcommand', '[pretext]/mathjaxknowl3.js'],
    paths: {pretext: "https://pretextbook.org/js/lib"},
  },
  startup: {
    /* Mathjax typesetting operation is under the control of React */
    typeset: false,
  },
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><link href="https://webwork-dev.uleth.ca/webwork2_files/js/apps/MathView/mathview.css" rel="stylesheet">
<script src="https://pretextbook.org/js/0.3/pretext-webwork/2.17/pretext-webwork.js"></script><script src="https://webwork-dev.uleth.ca/webwork2_files/node_modules/iframe-resizer/js/iframeResizer.min.js"></script><script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script><script>// Make *any* pre with class 'sagecell-html' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-html',
                       linked: true,
                       languages: ['html'],
                       evalButtonText: 'Evaluate (HTML)'});
</script><script>js_version = 0.3</script><script type="module" defer src="https://siefkenj.github.io/pretext-react/static/js/main.js"></script><link href="https://siefkenj.github.io/pretext-react/static/css/main.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/dejavu-serif" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz,wdth,wght@8..144,50..150,100..900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wdth,wght@75..100,300..800&amp;display=swap" rel="stylesheet">
<script type="application/json" class="js-hypothesis-config">{
    "openSidebar": false,    "showHighlights": true,}</script><script src="https://hypothes.is/embed.js" async=""></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.0.0dev3';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script type="text/javascript" src="https://runestone.academy/cdn/runestone/7.0.0dev3/prefix-runtime.71ffd81c0faeb38b.bundle.js"></script><script type="text/javascript" src="https://runestone.academy/cdn/runestone/7.0.0dev3/prefix-347.193e36c07abd0197.bundle.js"></script><script type="text/javascript" src="https://runestone.academy/cdn/runestone/7.0.0dev3/prefix-runestone.e543e0dd19670ae2.bundle.js"></script><link rel="stylesheet" type="text/css" href="https://runestone.academy/cdn/runestone/7.0.0dev3/prefix-347.f9add1ca35d5ad93.css">
<link rel="stylesheet" type="text/css" href="https://runestone.academy/cdn/runestone/7.0.0dev3/prefix-runestone.1f1f63d2cda36a4d.css">
</head>
<body id="Math3410" data-react-in-use="yes" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="linear-algebra.html"><span class="title">Linear Algebra:</span> <span class="subtitle">A second course, featuring proofs and Python</span></a></h1>
<p class="byline">Sean Fitzpatrick</p>
</div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<button id="closesearchresults" class="closesearchresults" onclick="document.getElementById('searchresultsplaceholder').style.display = 'none'; return false;">x</button><h2>Search Results: <span id="searchterms" class="searchterms"></span>
</h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><button class="toc-toggle button" aria-label="Show or hide table of contents"><span class="icon">‚ò∞</span><span class="name">Contents</span></button><span class="treebuttons"><a class="previous-button button" href="worksheet-dual-basis.html" title="Previous"><span class="icon">&lt;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-orthogonality.html" title="Up"><span class="icon">^</span><span class="name">Up</span></a><a class="next-button button" href="ch-diagonalization.html" title="Next"><span class="name">Next</span><span class="icon">&gt;</span></a></span><div class="searchbox"><div class="searchwidget">
<input id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search" onchange="doSearch()"><button id="searchbutton" class="searchbutton" type="button" onclick="doSearch()">üîç</button>
</div></div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\require{boldsymbol}\newcommand{\spn}{\operatorname{span}}
\newcommand{\bbm}{\begin{bmatrix}}
\newcommand{\ebm}{\end{bmatrix}}
\newcommand{\R}{\mathbb{R}}
\ifdefined\C
\renewcommand\C{\mathbb{C}}
\else
\newcommand\C{\mathbb{C}}
\fi
\newcommand{\im}{\operatorname{im}}
\newcommand{\nll}{\operatorname{null}}
\newcommand{\csp}{\operatorname{col}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\dotp}{\!\boldsymbol{\cdot}\!}
\newcommand{\len}[1]{\lVert #1\rVert}
\newcommand{\abs}[1]{\lvert #1\rvert}
\newcommand{\proj}[2]{\operatorname{proj}_{#1}{#2}}
\newcommand{\bz}{\overline{z}}
\newcommand{\zz}{\mathbf{z}}
\newcommand{\uu}{\mathbf{u}}
\newcommand{\vv}{\mathbf{v}}
\newcommand{\ww}{\mathbf{w}}
\newcommand{\xx}{\mathbf{x}}
\newcommand{\yy}{\mathbf{y}}
\newcommand{\zer}{\mathbf{0}}
\newcommand{\vecq}{\mathbf{q}}
\newcommand{\vecp}{\mathbf{p}}
\newcommand{\vece}{\mathbf{e}}
\newcommand{\basis}[2]{\{\mathbf{#1}_1,\mathbf{#1}_2,\ldots,\mathbf{#1}_{#2}\}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2"><ul class="structural">
<li>
<div class="toc-item"><a href="frontmatter-1.html" class="internal"><span class="title">Front Matter</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="colophon-1.html" class="internal"><span class="title">Colophon</span></a></div></li>
<li><div class="toc-item"><a href="preface-1.html" class="internal"><span class="title">Preface</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-vector-space.html" class="internal"><span class="codenumber">1</span> <span class="title">Vector spaces</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-vec-sp.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Definition and examples</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-vec-sp.html#exercises-1" class="internal"><span class="codenumber">1.1</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li><div class="toc-item"><a href="sec-vsp-properties.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Properties</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-subspace.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Subspaces</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-subspace.html#exercises-2" class="internal"><span class="codenumber">1.3</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li>
<div class="toc-item"><a href="sec-span.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Span</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-span.html#exercises-3" class="internal"><span class="codenumber">1.4</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li><div class="toc-item"><a href="worksheet-span.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Worksheet: understanding span</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-independence.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Linear Independence</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-independence.html#exercises-4" class="internal"><span class="codenumber">1.6</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li>
<div class="toc-item"><a href="sec-dimension.html" class="internal"><span class="codenumber">1.7</span> <span class="title">Basis and dimension</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-dimension.html#exercises-5" class="internal"><span class="codenumber">1.7</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li>
<div class="toc-item"><a href="sec-subspace-combine.html" class="internal"><span class="codenumber">1.8</span> <span class="title">New subspaces from old</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-subspace-combine.html#exercises-6" class="internal"><span class="codenumber">1.8</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-linear-trans.html" class="internal"><span class="codenumber">2</span> <span class="title">Linear Transformations</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-lin-tran-intro.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Definition and examples</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-lin-tran-intro.html#exercises-7" class="internal"><span class="codenumber">2.1</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li>
<div class="toc-item"><a href="sec-kernel-image.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Kernel and Image</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-kernel-image.html#exercises-8" class="internal"><span class="codenumber">2.2</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li>
<div class="toc-item"><a href="sec-isomorphism.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Isomorphisms, composition, and inverses</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-isomorphism.html#subsec-isomorphism" class="internal"><span class="codenumber">2.3.1</span> <span class="title">Isomorphisms</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-isomorphism.html#subsec-composition" class="internal"><span class="codenumber">2.3.2</span> <span class="title">Composition and inverses</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-isomorphism.html#exercises-9" class="internal"><span class="codenumber">2.3.2</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
</ul>
</li>
<li><div class="toc-item"><a href="worksheet-transformations.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Worksheet: matrix transformations</span></a></div></li>
<li><div class="toc-item"><a href="worksheet-recurrence.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Worksheet: linear recurrences</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-orthogonality.html" class="internal"><span class="codenumber">3</span> <span class="title">Orthogonality and Applications</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-orthogonal-sets.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Orthogonal sets of vectors</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-orthogonal-sets.html#subsec-dot-basics" class="internal"><span class="codenumber">3.1.1</span> <span class="title">Basic definitions and properties</span></a></div></li>
<li><div class="toc-item"><a href="sec-orthogonal-sets.html#subsec-ortho-sets" class="internal"><span class="codenumber">3.1.2</span> <span class="title">Orthogonal sets of vectors</span></a></div></li>
<li><div class="toc-item"><a href="sec-orthogonal-sets.html#exercises-10" class="internal"><span class="codenumber">3.1.3</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-gram-schmidt.html" class="internal"><span class="codenumber">3.2</span> <span class="title">The Gram-Schmidt Procedure</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-gram-schmidt.html#exercises-11" class="internal"><span class="codenumber">3.2</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li>
<div class="toc-item"><a href="section-projection.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Orthogonal Projection</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="section-projection.html#exercises-12" class="internal"><span class="codenumber">3.3</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li><div class="toc-item"><a href="worksheet-dual-basis.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Worksheet: dual basis.</span></a></div></li>
<li class="active"><div class="toc-item"><a href="worksheet-least-squares.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Worksheet: Least squares approximation</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-diagonalization.html" class="internal"><span class="codenumber">4</span> <span class="title">Diagonalization</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-eigen-basics.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Eigenvalues and Eigenvectors</span></a></div></li>
<li><div class="toc-item"><a href="subsec-ortho-diag.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Diagonalization of symmetric matrices</span></a></div></li>
<li><div class="toc-item"><a href="sec-quadratic.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Quadratic forms</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-complex.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Diagonalization of complex matrices</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-complex.html#subsec-complex-vector" class="internal"><span class="codenumber">4.4.1</span> <span class="title">Complex vectors</span></a></div></li>
<li><div class="toc-item"><a href="sec-complex.html#subsec-complex-matrix" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Complex matrices</span></a></div></li>
</ul>
</li>
<li><div class="toc-item"><a href="worksheet-dynamical.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Worksheet: linear dynamical systems</span></a></div></li>
<li>
<div class="toc-item"><a href="section-matrix-factor.html" class="internal"><span class="codenumber">4.6</span> <span class="title">Matrix Factorizations and Eigenvalues</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="section-matrix-factor.html#subsec-matrix-factorization" class="internal"><span class="codenumber">4.6.1</span> <span class="title">Matrix Factorizations</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-matrix-factor.html#pars-positive-ops" class="internal"><span class="codenumber">4.6.1.1</span> <span class="title">Positive Operators</span></a></div></li>
<li><div class="toc-item"><a href="section-matrix-factor.html#pars-singular-values" class="internal"><span class="codenumber">4.6.1.2</span> <span class="title">Singular Value Decomposition</span></a></div></li>
<li><div class="toc-item"><a href="section-matrix-factor.html#pars-qr-factor" class="internal"><span class="codenumber">4.6.1.3</span> <span class="title">QR Factorization</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-matrix-factor.html#subsec-compute-eigen" class="internal"><span class="codenumber">4.6.2</span> <span class="title">Computing Eigenvalues</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-matrix-factor.html#pars-power-method" class="internal"><span class="codenumber">4.6.2.1</span> <span class="title">The Power Method</span></a></div></li>
<li><div class="toc-item"><a href="section-matrix-factor.html#pars-qr-algorithm" class="internal"><span class="codenumber">4.6.2.2</span> <span class="title">The QR Algorithm</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li><div class="toc-item"><a href="worksheet-svd.html" class="internal"><span class="codenumber">4.7</span> <span class="title">Worksheet: Singular Value Decomposition</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-change-basis.html" class="internal"><span class="codenumber">5</span> <span class="title">Change of Basis</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-matrix-of-transformation.html" class="internal"><span class="codenumber">5.1</span> <span class="title">The matrix of a linear transformation</span></a></div></li>
<li><div class="toc-item"><a href="sec-matrix-operator.html" class="internal"><span class="codenumber">5.2</span> <span class="title">The matrix of a linear operator</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-direct-sum.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Direct Sums and Invariant Subspaces</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-direct-sum.html#subsec-invariant" class="internal"><span class="codenumber">5.3.1</span> <span class="title">Invariant subspaces</span></a></div></li>
<li><div class="toc-item"><a href="sec-direct-sum.html#subsec-eigenspace" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Eigenspaces</span></a></div></li>
<li><div class="toc-item"><a href="sec-direct-sum.html#subsec-direct-sum" class="internal"><span class="codenumber">5.3.3</span> <span class="title">Direct Sums</span></a></div></li>
</ul>
</li>
<li><div class="toc-item"><a href="worksheet-gen-eigen.html" class="internal"><span class="codenumber">5.4</span> <span class="title">Worksheet: generalized eigenvectors</span></a></div></li>
<li><div class="toc-item"><a href="sec-gen-eigen.html" class="internal"><span class="codenumber">5.5</span> <span class="title">Generalized eigenspaces</span></a></div></li>
<li><div class="toc-item"><a href="sec-jordan-form.html" class="internal"><span class="codenumber">5.6</span> <span class="title">Jordan Canonical Form</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="backmatter-1.html" class="internal"><span class="title">Back Matter</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="appendix-complex-review.html" class="internal"><span class="codenumber">A</span> <span class="title">Review of complex numbers</span></a></div></li>
<li>
<div class="toc-item"><a href="ch-computation.html" class="internal"><span class="codenumber">B</span> <span class="title">Computational Tools</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-jupyter.html" class="internal"><span class="codenumber">B.1</span> <span class="title">Jupyter</span></a></div></li>
<li><div class="toc-item"><a href="sec-python-basics.html" class="internal"><span class="codenumber">B.2</span> <span class="title">Python basics</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-sympy.html" class="internal"><span class="codenumber">B.3</span> <span class="title">SymPy for linear algebra</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-sympy.html#subsec-sympy-basics" class="internal"><span class="codenumber">B.3.1</span> <span class="title">SymPy basics</span></a></div></li>
<li><div class="toc-item"><a href="sec-sympy.html#subsec-sympy-matrix" class="internal"><span class="codenumber">B.3.2</span> <span class="title">Matrices in SymPy</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li><div class="toc-item"><a href="solutions-backmatter.html" class="internal"><span class="codenumber">C</span> <span class="title">Solutions to Selected Exercises</span></a></div></li>
</ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content">
<section class="worksheet" id="worksheet-least-squares"><h2 class="heading hide-type">
<span class="type">Worksheet</span> <span class="codenumber">3.5</span> <span class="title">Worksheet: Least squares approximation</span><div class="print-links">
<a href="worksheet-least-squares-a4.html" class="a4">A4</a><a href="worksheet-least-squares-letter.html" class="us">US</a>
</div>
</h2>
<section class="onepage" id="page-16"><div class="introduction" id="introduction-21">
<div class="para" id="p-1591">In many applied scenarios, it is not practical (or even, perhaps, possible) to find an exact solution to a problem. Sometimes we may be working with imperfect data. Other times, we may be dealing with a problem that is <dfn class="terminology">overdetermined</dfn>, <a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-7" id="fn-7"><sup>‚Äâ1‚Äâ</sup></a> such as a system of linear equations with more equations than variables. (Quite often, both of these issues may be present.)</div> <div class="para" id="p-1592">An overdetermined system is quite likely to be inconsistent. That is, our problem requires finding a solution to a system <span class="process-math">\(A\xx=\mathbf{b}\text{,}\)</span> where no such solution exists! When no solution is possible, we can ask whether it is instead possible to find a <em class="emphasis">best approximation</em>.</div> <div class="para" id="p-1593">What would a best approximation look like in this case? Let <span class="process-math">\(U=\csp(A)\)</span> denote the column space of <span class="process-math">\(A\text{,}\)</span> which we know is a subspace of <span class="process-math">\(\R^n\)</span> (assuming <span class="process-math">\(A\)</span> is an <span class="process-math">\(m\times n\)</span> matrix). The subspace <span class="process-math">\(U\)</span> is precisely the set of all vectors <span class="process-math">\(\yy\)</span> such that <span class="process-math">\(A\xx=\yy\)</span> has a solution. Among these vectors, we would like to find the one that is <em class="emphasis">closest</em> to <span class="process-math">\(\mathbf{b}\text{,}\)</span> in the sense that <span class="process-math">\(\len{\yy-\mathbf{b}}\)</span> is as small as possible.</div> <div class="para" id="p-1594">But we know exactly what this vector <span class="process-math">\(\yy\)</span> should be: the orthogonal projection of <span class="process-math">\(\mathbf{b}\)</span> onto <span class="process-math">\(U\text{.}\)</span>
</div>
</div> <div class="para" id="p-1595">The presentation in this worksheet is based on the one given in the text by Nicholson (see Section 5.6). Further details may be found there, or, for the more statistically inclined, on <a class="external" href="https://en.wikipedia.org/wiki/Least_squares" target="_blank">Wikipedia</a><a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-8" id="fn-8"><sup>‚Äâ2‚Äâ</sup></a>.</div> <div class="para logical" id="p-1596">
<div class="para">Given an inconsistent system <span class="process-math">\(A\xx = \mathbf{b}\text{,}\)</span> we have two problems to solve:</div>
<ol class="lower-alpha">
<li id="li-304"><div class="para" id="p-1597">Find the vector <span class="process-math">\(\yy = \proj{U}{\mathbf{b}}\text{,}\)</span> where <span class="process-math">\(U=\csp(A)\)</span>
</div></li>
<li id="li-305"><div class="para" id="p-1598">Find a vector <span class="process-math">\(\zz\)</span> such that <span class="process-math">\(A\zz=\yy\)</span>
</div></li>
</ol>
<div class="para">The vector <span class="process-math">\(\zz\)</span> is then our approximate solution.</div>
</div> <div class="para logical" id="p-1599">
<div class="para">This can be done directly, of course:</div>
<ol class="lower-alpha">
<li id="li-306"><div class="para" id="p-1600">Find a basis for <span class="process-math">\(U\)</span>
</div></li>
<li id="li-307"><div class="para" id="p-1601">Use the <a href="" class="xref" data-knowl="./knowl/thm-gram-schmidt.html" title="Theorem 3.2.4: Gram-Schmidt Orthonormalization Algorithm">Gram-Schmidt Orthonormalization Algorithm</a> to construct an orthogonal basis for <span class="process-math">\(U\)</span>
</div></li>
<li id="li-308"><div class="para" id="p-1602">Use this orthogonal basis to compute <span class="process-math">\(\yy=\proj{U}{\mathbf{b}}\)</span>
</div></li>
<li id="li-309"><div class="para" id="p-1603">Solve the system <span class="process-math">\(A\zz=\yy\text{.}\)</span>
</div></li>
</ol>
</div> <div class="para logical" id="p-1604">
<div class="para">But there is another way to proceed: we know that <span class="process-math">\(\mathbf{b}-\yy=\mathbf{b}-A\zz\in U^\bot\text{,}\)</span> so for any vector <span class="process-math">\(A\xx\in U\text{,}\)</span> <span class="process-math">\((A\xx)\dotp (\mathbf{b}-A\zz)=0\text{.}\)</span> Therefore,</div>
<div class="displaymath process-math" id="md-61">
\begin{align*}
(A\xx)\dotp (\mathbf{b}-A\zz) \amp =0\\
(A\xx)^T(\mathbf{b}-A\zz) \amp =0\\
\xx^TA^T(\mathbf{b}-A\zz) \amp =0\\
\xx^T(A^T\mathbf{b}-A^TA\zz) \amp =0\text{,}
\end{align*}
</div>
<div class="para">for any vector <span class="process-math">\(\xx\in\R^n\text{.}\)</span>
</div>
</div> <div class="para logical" id="p-1605">
<div class="para">Therefore, <span class="process-math">\(A^T\mathbf{b}-A^TA\zz=0\text{,}\)</span> or</div>
<div class="displaymath process-math" id="eqn-normal-approximation">
\begin{equation}
A^TA\zz = A^T\mathbf{b}\text{.}\tag{3.5.1}
\end{equation}
</div>
<div class="para">Solving this system, called the <dfn class="terminology">normal equations</dfn> for <span class="process-math">\(\zz\text{,}\)</span> will yield our approximate solution.</div>
</div></section><section class="onepage" id="page-17"><div class="para logical" id="p-1606">
<div class="para">To begin, let‚Äôs compare the two methods discussed above for finding an approximate solution. Consider the system of equations <span class="process-math">\(A\xx=\mathbf{b}\text{,}\)</span> where</div>
<div class="displaymath process-math">
\begin{equation*}
A = \bbm 3\amp -1 \amp 0\amp 5\\
-2\amp 7\amp -3\amp 0\\
4\amp -1\amp 2\amp 3\\
0\amp 3\amp 9\amp -1\\
7\amp -2\amp 4\amp -5\\
1\amp 0\amp 3\amp -8\ebm \text{ and } \mathbf{b} = \bbm 4\\0\\1\\2\\-5\\-1\ebm\text{.}
\end{equation*}
</div>
</div> <article class="exercise exercise-like" id="exercise-145"><h3 class="heading"><span class="codenumber">1<span class="period">.</span></span></h3>
<div class="para" id="p-1607">Confirm that the system has no solution.</div>
<div class="workspace" data-space="1.5in"></div></article> <pre class="ptx-sagecell sagecell-sage" id="sage-53"><script type="text/x-sage">from sympy import Matrix,init_printing
init_printing()
</script></pre> <pre class="ptx-sagecell sagecell-html" id="sage-54"><script type="text/x-sage">In Jupyter, double-click to edit, and change this to a markdown cell to explain your results.
</script></pre> <article class="exercise exercise-like" id="exercise-146"><h3 class="heading"><span class="codenumber">2<span class="period">.</span></span></h3>
<div class="para" id="p-1608">Find an orthogonal basis for the column space of <span class="process-math">\(A\text{.}\)</span>
</div>
<div class="workspace" data-space="3in"></div></article> <pre class="ptx-sagecell sagecell-sage" id="sage-55"><script type="text/x-sage">from sympy import GramSchmidt
</script></pre></section><section class="onepage" id="page-18"><article class="exercise exercise-like" id="exercise-147"><h3 class="heading"><span class="codenumber">3<span class="period">.</span></span></h3>
<div class="para" id="p-1609">Compute the projection <span class="process-math">\(\yy\)</span> of <span class="process-math">\(\mathbf{b}\)</span> onto the column space of <span class="process-math">\(A\text{.}\)</span>
</div>
<div class="workspace" data-space="1.9in"></div></article> <pre class="ptx-sagecell sagecell-sage" id="sage-56"><script type="text/x-sage"></script></pre> <article class="exercise exercise-like" id="exercise-148"><h3 class="heading"><span class="codenumber">4<span class="period">.</span></span></h3>
<div class="para" id="p-1610">Solve the system <span class="process-math">\(A\zz=\yy\)</span> for <span class="process-math">\(\zz\text{.}\)</span>
</div>
<div class="workspace" data-space="1.9in"></div></article> <pre class="ptx-sagecell sagecell-sage" id="sage-57"><script type="text/x-sage"></script></pre> <article class="exercise exercise-like" id="exercise-149"><h3 class="heading"><span class="codenumber">5<span class="period">.</span></span></h3>
<div class="para" id="p-1611">Solve the normal equations <a href="" class="xref" data-knowl="./knowl/eqn-normal-approximation.html" title="Equation 3.5.1">(3.5.1)</a> for <span class="process-math">\(\zz\text{.}\)</span>
</div>
<div class="workspace" data-space="1.9in"></div></article> <pre class="ptx-sagecell sagecell-sage" id="sage-58"><script type="text/x-sage"></script></pre></section><section class="onepage" id="page-19"><div class="para" id="p-1612">Next, we want to consider a problem found in many introductory science labs: finding a line of <em class="emphasis">best fit</em>. The situation is as follows: in some experiment, data points <span class="process-math">\((x_1,y_1), (x_2,y_2),\ldots, (x_n,y_n)\)</span> have been found. We would like to find a function <span class="process-math">\(y=f(x)=ax+b\)</span> such that for each <span class="process-math">\(i=1,2,\ldots, n\text{,}\)</span> the value of <span class="process-math">\(f(x_i)\)</span> is as close as possible to <span class="process-math">\(y_i\text{.}\)</span>
</div> <div class="para" id="p-1613">Note that we have only two parameters available to tune: <span class="process-math">\(a\)</span> and <span class="process-math">\(b\text{.}\)</span> We assume that some reasoning or experimental evidence has led us to conclude that a linear fit is reasonable. The challenge here is to make precise what we mean by ‚Äúas close as possible‚Äù. We have <span class="process-math">\(n\)</span> differences (sometimes called <dfn class="terminology">residuals</dfn>) <span class="process-math">\(r_i=y_i-f(x_i)\)</span> that we want to make small, by adjusting <span class="process-math">\(a\)</span> and <span class="process-math">\(b\text{.}\)</span> But making one of the <span class="process-math">\(r_i\)</span> smaller might make another one larger!</div> <div class="para logical" id="p-1614">
<div class="para">A measure of the overall error in the fit of the line is given by the sum of squares</div>
<div class="displaymath process-math">
\begin{equation*}
S = r_1^2+r_2^2+\cdots + r_n^2\text{,}
\end{equation*}
</div>
<div class="para">and this is the quantity that we want to minimize. (Hence the name, ‚Äúleast squares‚Äù.)</div>
</div> <div class="para logical" id="p-1615">
<div class="para">Let <span class="process-math">\(\vv=\bbm a\\b\ebm\text{,}\)</span> and note that <span class="process-math">\(f(x)=a+bx = \bbm 1\amp x\ebm\vv\text{.}\)</span> Set <span class="process-math">\(\yy = \bbm y_1\\y_2\\\vdots\\y_n\ebm\)</span> and <span class="process-math">\(\mathbf{r}=\bbm r_1\\r_2\\\vdots\\r_n\ebm\text{.}\)</span> Then</div>
<div class="displaymath process-math">
\begin{equation*}
\mathbf{r}=\yy - A\vv\text{,}
\end{equation*}
</div>
<div class="para">where <span class="process-math">\(A = \bbm 1\amp x_1\\1\amp x_2\\\vdots \amp \vdots \\1\amp x_n\ebm\text{.}\)</span> (Note that we are using <span class="process-math">\(\yy\)</span> to denote a different sort of vector than on the previous page.)</div>
</div> <div class="para logical" id="p-1616">
<div class="para">We can safely assume that an exact solution <span class="process-math">\(A\vv=\yy\)</span> is impossible, so we search for an approximate one, with <span class="process-math">\(\mathbf{r}\)</span> as small as possible. (Note that the magnitude of <span class="process-math">\(\mathbf{r}\)</span> satisfies <span class="process-math">\(\len{\mathbf{r}}^2=S\text{.}\)</span>) But a solution <span class="process-math">\(\zz\)</span> that makes <span class="process-math">\(\yy-A\zz\)</span> as small as possible is exactly the sort of approximate solution that we just learned to calculate! Solving the normal equations for <span class="process-math">\(\zz=\bbm a\\b\ebm\text{,}\)</span> we find that</div>
<div class="displaymath process-math">
\begin{equation*}
\zz = (A^TA)^{-1}(A^T\yy)\text{.}
\end{equation*}
</div>
</div></section><section class="onepage" id="page-20"><article class="exercise exercise-like" id="exercise-150"><h3 class="heading"><span class="codenumber">6<span class="period">.</span></span></h3>
<div class="para logical" id="p-1617">
<div class="para">Find the equation of the best fit line for the following set of data points:</div>
<div class="displaymath process-math">
\begin{equation*}
(1,2.03), (2, 2.37), (3, 2.91), (4, 3.58), (5, 4.11), (6, 4.55), (7, 4.93), (8, 5.44), (9, 6.18)\text{.}
\end{equation*}
</div>
</div>
<div class="workspace" data-space="3in"></div></article> <pre class="ptx-sagecell sagecell-sage" id="sage-59"><script type="text/x-sage"></script></pre> <article class="exercise exercise-like" id="exercise-151"><h3 class="heading"><span class="codenumber">7<span class="period">.</span></span></h3>
<div class="para" id="p-1618">Suppose we were instead trying to find the best <em class="emphasis">quadratic</em> fit for a dataset. What would our parameters be? What would the matrix <span class="process-math">\(A\)</span> look like? Illustrate with an example of your own.</div>
<div class="workspace" data-space="4in"></div></article></section></section><div class="hidden-content tex2jax_ignore" id="hk-fn-7"><div class="fn">The term ‚Äúoverdetermined‚Äù is common in statistics. In other areas, such as physics, the term ‚Äúover-constrained‚Äù is used instead.</div></div>
<div class="hidden-content tex2jax_ignore" id="hk-fn-8"><div class="fn"><code class="code-inline tex2jax_ignore">en.wikipedia.org/wiki/Least_squares</code></div></div>
</div>
<div class="ptx-content-footer">
<a class="previous-button button" href="worksheet-dual-basis.html" title="Previous"><span class="icon">&lt;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon">^</span><span class="name">Top</span></a><a class="next-button button" href="ch-diagonalization.html" title="Next"><span class="name">Next</span><span class="icon">&gt;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:black; fill:none"><polyline points="472,3590 472,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
